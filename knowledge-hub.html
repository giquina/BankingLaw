<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Primary Meta Tags -->
    <title>Knowledge Hub | JuriBank | Up-to-Date UK Banking & Financial Law</title>
    <meta name="title" content="Knowledge Hub | JuriBank | Up-to-Date UK Banking & Financial Law">
    <meta name="description" content="Comprehensive knowledge base of UK banking and financial law, updated daily from official sources. Access FCA regulations, bank complaint procedures, PPI guides, investment protection rules, and document templates.">
    <meta name="keywords" content="UK banking law, FCA regulations, PPI claims guide, bank complaints, investment protection, packaged accounts, financial services law, consumer rights">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta name="author" content="JuriBank Student Legal Platform">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://juribank.co.uk/knowledge-hub.html">
    <meta property="og:title" content="Knowledge Hub | JuriBank | Up-to-Date UK Banking & Financial Law">
    <meta property="og:description" content="Comprehensive knowledge base of UK banking and financial law, updated daily from official sources.">
    <meta property="og:image" content="https://juribank.co.uk/assets/images/knowledge-hub-preview.png">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="Knowledge Hub | JuriBank | Up-to-Date UK Banking & Financial Law">
    <meta property="twitter:description" content="Comprehensive knowledge base of UK banking and financial law, updated daily from official sources.">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
    
    <!-- Tailwind CSS with proper configuration -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Configure Tailwind after it loads
        window.addEventListener('DOMContentLoaded', function() {
            if (window.tailwind && window.tailwind.config) {
                tailwind.config = {
                    theme: {
                        extend: {
                            colors: {
                                'student-blue': '#2563eb',
                                'student-green': '#059669',
                                'student-orange': '#ea580c',
                                'trust-gray': '#64748b',
                                'background-cream': '#fefdf8'
                            },
                            fontFamily: {
                                'inter': ['Inter', 'sans-serif']
                            }
                        }
                    }
                };
            }
        });
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #2563eb 0%, #059669 100%); }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-4px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
        .filter-active { background: #2563eb; color: white; }
        .search-highlight { background: #fef3c7; }
        .citation { font-style: italic; color: #4b5563; font-size: 0.9em; }
        .update-badge { animation: pulse 2s infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .article-content h3 { color: #1f2937; font-weight: 600; margin: 1.5rem 0 0.75rem; }
        .article-content p { margin-bottom: 1rem; line-height: 1.7; }
        .article-content ul { margin-bottom: 1rem; padding-left: 1.5rem; }
        .article-content li { margin-bottom: 0.5rem; }
        .sticky-search { 
            position: sticky; 
            top: 80px; 
            z-index: 40; 
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body class="bg-background-cream">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <a href="index.html">
                        <img src="/assets/juribank-logo.svg" alt="JuriBank" class="h-8 w-auto">
                    </a>
                    <span class="ml-2 text-sm bg-student-blue text-white px-2 py-1 rounded-full">by Students</span>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="index.html#tools" class="text-gray-700 hover:text-student-blue font-medium">Free Tools</a>
                    <a href="knowledge-hub.html" class="text-student-blue font-semibold">Knowledge Hub</a>
                    <a href="index.html#community" class="text-gray-700 hover:text-student-blue font-medium">Community</a>
                    <a href="how-it-works.html" class="text-gray-700 hover:text-student-blue font-medium">How It Works</a>
                    <button class="bg-student-blue text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700">
                        Sign Up Free
                    </button>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-toggle" class="text-gray-700">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t">
            <div class="px-4 py-2 space-y-2">
                <a href="index.html#tools" class="block py-2 text-gray-700">Free Tools</a>
                <a href="knowledge-hub.html" class="block py-2 text-student-blue font-semibold">Knowledge Hub</a>
                <a href="index.html#community" class="block py-2 text-gray-700">Community</a>
                <a href="how-it-works.html" class="block py-2 text-gray-700">How It Works</a>
                <button class="w-full bg-student-blue text-white py-2 rounded-lg font-medium mt-2">
                    Sign Up Free
                </button>
            </div>
        </div>
    </nav>

    <!-- Header Section -->
    <section class="bg-gradient-to-r from-blue-50 to-green-50 py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">UK Banking & Financial Law Knowledge Hub</h1>
                <p class="text-xl text-gray-600 mb-6">Real-time updates from official sources • Educational guidance by law students</p>
                <div class="flex flex-wrap justify-center gap-2 text-sm">
                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full">
                        <i class="fas fa-database mr-1"></i>Gov.UK API
                    </span>
                    <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full">
                        <i class="fas fa-shield-alt mr-1"></i>FCA Data
                    </span>
                    <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full">
                        <i class="fas fa-balance-scale mr-1"></i>Ombudsman
                    </span>
                    <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full">
                        <i class="fas fa-clock mr-1"></i>Daily Updates
                    </span>
                </div>
            </div>

            <!-- Search and Stats -->
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
                <div class="grid md:grid-cols-4 gap-6 items-center">
                    <div class="md:col-span-2">
                        <div class="relative">
                            <input type="text" 
                                   id="search-input"
                                   placeholder="Search regulations, guides, templates..." 
                                   class="w-full pl-12 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-student-blue focus:border-student-blue">
                            <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        </div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-student-blue">2,847</div>
                        <div class="text-sm text-gray-600">Legal References</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-student-green">24h</div>
                        <div class="text-sm text-gray-600">Update Frequency</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <section class="py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

            <div class="grid lg:grid-cols-4 gap-8">
                <!-- Filters Sidebar -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-2xl shadow-lg p-6 sticky-search">
                        <h3 class="text-lg font-semibold mb-4">Filter Content</h3>
                        
                        <!-- Topic Filter -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-3">Topic</label>
                            <div class="space-y-2">
                                <button class="filter-btn w-full text-left p-2 rounded-lg hover:bg-gray-50 flex items-center justify-between" data-filter="all">
                                    <span>All Topics</span>
                                    <span class="bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded-full">247</span>
                                </button>
                                <button class="filter-btn w-full text-left p-2 rounded-lg hover:bg-gray-50 flex items-center justify-between" data-filter="banking">
                                    <span>Banking Rights</span>
                                    <span class="bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded-full">89</span>
                                </button>
                                <button class="filter-btn w-full text-left p-2 rounded-lg hover:bg-gray-50 flex items-center justify-between" data-filter="ppi">
                                    <span>PPI Claims</span>
                                    <span class="bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded-full">67</span>
                                </button>
                                <button class="filter-btn w-full text-left p-2 rounded-lg hover:bg-gray-50 flex items-center justify-between" data-filter="investment">
                                    <span>Investment Complaints</span>
                                    <span class="bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded-full">45</span>
                                </button>
                                <button class="filter-btn w-full text-left p-2 rounded-lg hover:bg-gray-50 flex items-center justify-between" data-filter="packaged">
                                    <span>Packaged Accounts</span>
                                    <span class="bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded-full">31</span>
                                </button>
                                <button class="filter-btn w-full text-left p-2 rounded-lg hover:bg-gray-50 flex items-center justify-between" data-filter="timelines">
                                    <span>Legal Timelines</span>
                                    <span class="bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded-full">15</span>
                                </button>
                            </div>
                        </div>

                        <!-- Source Filter -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-3">Source</label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="mr-2 text-student-blue">
                                    <span class="text-sm">Gov.UK</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="mr-2 text-student-blue">
                                    <span class="text-sm">FCA</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="mr-2 text-student-blue">
                                    <span class="text-sm">Financial Ombudsman</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="mr-2 text-student-blue">
                                    <span class="text-sm">PRA</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="mr-2 text-student-blue">
                                    <span class="text-sm">FSCS</span>
                                </label>
                            </div>
                        </div>

                        <!-- Update Filter -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-3">Updated</label>
                            <select class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-student-blue">
                                <option>Last 7 days</option>
                                <option>Last 30 days</option>
                                <option>Last 6 months</option>
                                <option>All time</option>
                            </select>
                        </div>

                        <!-- Document Type -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-3">Document Type</label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="mr-2 text-student-blue">
                                    <span class="text-sm">Guides</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="mr-2 text-student-blue">
                                    <span class="text-sm">Templates</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="mr-2 text-student-blue">
                                    <span class="text-sm">Regulations</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="mr-2 text-student-blue">
                                    <span class="text-sm">Case Studies</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Content Area -->
                <div class="lg:col-span-3">
                    <div id="knowledge-content" class="space-y-8">

                        
                        <!-- Banking Rights & Regulations Section -->
                        <div class="content-section" data-category="banking">
                            <div class="bg-white rounded-2xl shadow-lg p-8">
                                <div class="flex items-start justify-between mb-6">
                                    <div class="flex items-center">
                                        <div class="bg-blue-100 w-12 h-12 rounded-xl flex items-center justify-center mr-4">
                                            <i class="fas fa-landmark text-blue-600 text-xl"></i>
                                        </div>
                                        <div>
                                            <h2 class="text-2xl font-bold text-gray-900">Banking Rights & Regulations</h2>
                                            <p class="text-gray-600">Current FCA rules, bank charge limits, complaint procedures</p>
                                            <div class="flex items-center mt-2">
                                                <span class="update-badge bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full mr-2">
                                                    <i class="fas fa-clock mr-1"></i>Updated 6 hours ago
                                                </span>
                                                <span class="text-xs text-gray-500">Source: FCA, Gov.UK</span>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="text-gray-400 hover:text-student-blue">
                                        <i class="fas fa-bookmark text-xl"></i>
                                    </button>
                                </div>

                                <div class="article-content">
                                    <h3>Current Bank Charge Regulations (2024)</h3>
                                    <p>Under current FCA regulations, banks must provide clear information about all charges and offer reasonable alternatives before applying them. The key regulations include:</p>
                                    
                                    <ul class="list-disc pl-6 space-y-2">
                                        <li><strong>Overdraft charges:</strong> Must be clearly disclosed and proportionate to the cost of providing the service</li>
                                        <li><strong>Monthly fees:</strong> Banks must demonstrate clear value for packaged account fees</li>
                                        <li><strong>International transfer fees:</strong> Must be disclosed upfront with clear exchange rates</li>
                                        <li><strong>ATM charges:</strong> Clear warnings required for out-of-network withdrawals</li>
                                    </ul>
                                    
                                    <div class="bg-blue-50 p-4 rounded-lg mt-4">
                                        <h4 class="font-semibold text-blue-900 mb-2">Your Rights When Charges Are Applied</h4>
                                        <p class="text-blue-800 text-sm">You have the right to challenge any charges that seem excessive or were not properly disclosed. Banks must investigate complaints within 8 weeks and provide written responses.</p>
                                    </div>

                                    <h3>How to Complain About Bank Charges</h3>
                                    <p>Follow these steps if you believe you've been charged unfairly:</p>
                                    
                                    <ol class="list-decimal pl-6 space-y-2">
                                        <li>Contact your bank's complaints department directly</li>
                                        <li>Reference the specific charges and dates</li>
                                        <li>Explain why you believe the charges are unfair</li>
                                        <li>Request a full refund and review of your account</li>
                                        <li>If unsatisfied after 8 weeks, escalate to the Financial Ombudsman Service</li>
                                    </ol>
                                </div>

                                <div class="mt-6 flex flex-wrap gap-2">
                                    <span class="bg-blue-100 text-blue-800 text-xs px-3 py-1 rounded-full">Banking Charges</span>
                                    <span class="bg-green-100 text-green-800 text-xs px-3 py-1 rounded-full">FCA Rules</span>
                                    <span class="bg-purple-100 text-purple-800 text-xs px-3 py-1 rounded-full">Consumer Rights</span>
                                </div>

                                <div class="mt-6 flex items-center justify-between">
                                    <div class="citation">
                                        Ref: FCA Handbook BCOBS 4.1, Payment Services Regulations 2017
                                    </div>
                                    <button class="bg-student-blue text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                                        <i class="fas fa-download mr-2"></i>Download Guide
                                    </button>
                                </div>
                            </div>
                        </div>

    <!-- Footer -->
    <footer class="bg-gray-50 py-12 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <div class="flex items-center justify-center mb-4">
                    <img src="/assets/juribank-logo.svg" alt="JuriBank" class="h-6 w-auto mr-2">
                    <span class="text-lg font-semibold text-gray-900">JuriBank</span>
                    <span class="ml-2 text-sm bg-student-blue text-white px-2 py-1 rounded-full">by Students</span>
                </div>
                <p class="text-gray-600 text-sm mb-4">Educational guidance powered by real-time official data</p>
                <div class="flex justify-center space-x-6 text-sm">
                    <a href="index.html" class="text-gray-600 hover:text-student-blue">Home</a>
                    <a href="claim-wizard.html" class="text-gray-600 hover:text-student-blue">Free Tools</a>
                    <a href="dashboard.html" class="text-gray-600 hover:text-student-blue">Dashboard</a>
                    <a href="#" class="text-gray-600 hover:text-student-blue">Community</a>
                    <a href="#" class="text-gray-600 hover:text-student-blue">Support</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Knowledge Hub API Integration -->
    <script src="/src/knowledge-hub-api.js"></script>
    <script>
        // Knowledge Hub Application
        class KnowledgeHubApp {
            constructor() {
                this.currentFilters = {};
                this.searchQuery = '';
                this.isLoading = false;
                
                this.initializeEventListeners();
                this.initializeSearchAndFilters();
            }

            initializeEventListeners() {
                // Search functionality
                const searchInput = document.querySelector('input[type="text"]');
                if (searchInput) {
                    searchInput.addEventListener('input', (e) => {
                        this.searchQuery = e.target.value;
                        this.debounceSearch();
                    });
                }

                // Filter functionality
                document.querySelectorAll('select').forEach(select => {
                    select.addEventListener('change', (e) => {
                        this.updateFilters();
                        this.performSearch();
                    });
                });

                document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                    checkbox.addEventListener('change', (e) => {
                        this.updateFilters();
                        this.performSearch();
                    });
                });

                // Load more button
                const loadMoreBtn = document.getElementById('load-more-btn');
                if (loadMoreBtn) {
                    loadMoreBtn.addEventListener('click', () => this.loadMoreContent());
                }

                // Listen for Knowledge Hub updates
                document.addEventListener('knowledge-hub-updated', (e) => {
                    this.updateResultsCount(e.detail.content.length);
                });
            }

            initializeSearchAndFilters() {
                // Set up debounced search
                this.searchDebounceTimer = null;
                
                // Initialize filters
                this.updateFilters();
            }

            debounceSearch() {
                clearTimeout(this.searchDebounceTimer);
                this.searchDebounceTimer = setTimeout(() => {
                    this.performSearch();
                }, 300);
            }

            updateFilters() {
                const topicSelect = document.querySelector('select[name="topic"]') || 
                                 document.querySelectorAll('select')[1];
                const sourceSelect = document.querySelector('select[name="source"]') || 
                                   document.querySelectorAll('select')[2];
                const timeSelect = document.querySelector('select[name="time"]') || 
                                 document.querySelectorAll('select')[3];
                
                this.currentFilters = {
                    topic: topicSelect?.value || 'All Topics',
                    source: sourceSelect?.value || 'All Sources',
                    timeRange: timeSelect?.value || 'Last 7 days',
                    contentType: this.getSelectedContentTypes()
                };
            }

            getSelectedContentTypes() {
                const checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
                const types = [];
                
                checkboxes.forEach(checkbox => {
                    const label = checkbox.parentElement.textContent.trim();
                    if (label.includes('Legal Updates')) types.push('guidance', 'regulation');
                    if (label.includes('Templates')) types.push('template');
                    if (label.includes('Statistics')) types.push('statistics', 'report');
                });
                
                return types.length > 0 ? types : null;
            }

            async performSearch() {
                if (this.isLoading) return;
                
                this.isLoading = true;
                this.showLoadingState();

                try {
                    let results;
                    
                    if (this.searchQuery) {
                        results = await knowledgeHub.search(this.searchQuery, this.currentFilters);
                    } else {
                        // Apply filters to current content
                        results = await this.applyFiltersToCurrentContent();
                    }

                    this.updateResultsCount(results.length);
                    
                } catch (error) {
                    console.error('Search failed:', error);
                    this.showErrorState();
                } finally {
                    this.isLoading = false;
                }
            }

            async applyFiltersToCurrentContent() {
                // Get fresh content with filters applied
                const freshContent = await Promise.allSettled([
                    knowledgeHub.fetchGovUKUpdates(),
                    knowledgeHub.fetchFCAUpdates(),
                    knowledgeHub.fetchOmbudsmanData(),
                    knowledgeHub.fetchBankOfEnglandNews()
                ]);

                const allContent = knowledgeHub.processInitialData(freshContent);
                const filteredContent = knowledgeHub.applyFilters(allContent, this.currentFilters);
                
                knowledgeHub.updateContentList(filteredContent);
                return filteredContent;
            }

            showLoadingState() {
                const contentContainer = document.querySelector('.content-list-container');
                if (!contentContainer) return;

                contentContainer.innerHTML = `
                    <div class="text-center py-12">
                        <div class="animate-spin w-8 h-8 border-4 border-student-blue border-t-transparent rounded-full mx-auto mb-4"></div>
                        <p class="text-gray-600">Searching knowledge hub...</p>
                    </div>
                `;
            }

            showErrorState() {
                const contentContainer = document.querySelector('.content-list-container');
                if (!contentContainer) return;

                contentContainer.innerHTML = `
                    <div class="text-center py-12">
                        <div class="bg-red-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-exclamation-triangle text-red-600 text-2xl"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-2">Search Failed</h3>
                        <p class="text-gray-600 mb-4">Unable to search knowledge hub at this time.</p>
                        <button onclick="location.reload()" class="bg-student-blue text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                            Try Again
                        </button>
                    </div>
                `;
            }

            updateResultsCount(count) {
                const resultsSpan = document.getElementById('results-count');
                if (resultsSpan) {
                    resultsSpan.textContent = `Showing ${Math.min(count, 10)} of ${count} resources`;
                }
            }

            async loadMoreContent() {
                const loadMoreBtn = document.getElementById('load-more-btn');
                if (!loadMoreBtn || this.isLoading) return;

                this.isLoading = true;
                loadMoreBtn.innerHTML = '<i class="fas fa-spinner animate-spin mr-2"></i>Loading...';
                loadMoreBtn.disabled = true;

                try {
                    // Simulate loading more content
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    // In a real app, this would load the next page of results
                    console.log('Load more content functionality');
                    
                } catch (error) {
                    console.error('Failed to load more content:', error);
                } finally {
                    loadMoreBtn.innerHTML = 'Load More Resources';
                    loadMoreBtn.disabled = false;
                    this.isLoading = false;
                }
            }
        }

        // Bookmark and favorite functionality
        function toggleBookmark(itemId) {
            const bookmarkBtn = document.querySelector(`[onclick="knowledgeHub.toggleBookmark('${itemId}')"]`);
            if (!bookmarkBtn) return;

            const icon = bookmarkBtn.querySelector('i');
            const isBookmarked = icon.classList.contains('fas');

            if (isBookmarked) {
                icon.classList.remove('fas');
                icon.classList.add('far');
                bookmarkBtn.classList.remove('text-student-blue');
                bookmarkBtn.classList.add('text-gray-400');
                this.showNotification('Bookmark removed', 'info');
            } else {
                // Check bookmark limit for free users
                const currentBookmarks = document.querySelectorAll('.fas.fa-bookmark').length;
                if (currentBookmarks >= 3) {
                    this.showUpgradePrompt('You\'ve reached your bookmark limit. Upgrade for unlimited bookmarks!');
                    return;
                }

                icon.classList.remove('far');
                icon.classList.add('fas');
                bookmarkBtn.classList.remove('text-gray-400');
                bookmarkBtn.classList.add('text-student-blue');
                this.showNotification('Bookmark added', 'success');
            }
        }

        function toggleFavorite(itemId) {
            const favoriteBtn = document.querySelector(`[onclick="knowledgeHub.toggleFavorite('${itemId}')"]`);
            if (!favoriteBtn) return;

            const icon = favoriteBtn.querySelector('i');
            const isFavorited = favoriteBtn.classList.contains('text-red-500');

            if (isFavorited) {
                favoriteBtn.classList.remove('text-red-500');
                favoriteBtn.classList.add('text-gray-400');
                this.showNotification('Removed from favorites', 'info');
            } else {
                favoriteBtn.classList.remove('text-gray-400');
                favoriteBtn.classList.add('text-red-500');
                this.showNotification('Added to favorites', 'success');
            }
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-20 right-4 z-50 px-4 py-3 rounded-lg shadow-lg text-white transform transition-all duration-300 translate-x-full`;
            
            switch (type) {
                case 'success':
                    notification.classList.add('bg-green-500');
                    break;
                case 'error':
                    notification.classList.add('bg-red-500');
                    break;
                default:
                    notification.classList.add('bg-blue-500');
            }

            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation-triangle' : 'info-circle'} mr-2"></i>
                    <span>${message}</span>
                </div>
            `;

            document.body.appendChild(notification);

            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);

            // Remove after 3 seconds
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        function showUpgradePrompt(message) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl p-8 max-w-md mx-4">
                    <div class="text-center">
                        <div class="bg-yellow-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-crown text-yellow-600 text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-900 mb-4">Upgrade Required</h3>
                        <p class="text-gray-600 mb-6">${message}</p>
                        <div class="flex space-x-3">
                            <button onclick="this.closest('.fixed').remove()" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                                Not Now
                            </button>
                            <button class="flex-1 px-4 py-2 bg-student-blue text-white rounded-lg hover:bg-blue-700">
                                Upgrade £9.99/month
                            </button>
                        </div>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
            
            // Remove on outside click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.remove();
            });
        }

    </script>

    <!-- Enhanced Knowledge Hub with API Integration -->
    <script src="/src/api/knowledge-hub-api.js"></script>
    <script src="/src/knowledge-hub.js"></script>
</body>
</html>