<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community Forum - JuriBank Educational Platform</title>
    <meta name="description" content="Anonymous community forum for legal and financial guidance. Moderated by law students from top London university.">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'student-blue': '#2563eb',
                        'student-green': '#059669',
                        'student-orange': '#ea580c',
                        'trust-gray': '#64748b',
                        'background-cream': '#fefdf8'
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1); }
        .category-active { background: linear-gradient(135deg, #2563eb 0%, #059669 100%); }
        .post-item { transition: all 0.2s ease; }
        .post-item:hover { background-color: #f8fafc; }
        .moderator-badge { background: linear-gradient(45deg, #2563eb, #1d4ed8); }
        .student-badge { background: linear-gradient(45deg, #059669, #047857); }
        .verified-badge { background: linear-gradient(45deg, #ea580c, #dc2626); }
        .floating-composer { 
            transform: translateY(100%); 
            transition: transform 0.3s ease;
        }
        .floating-composer.active { 
            transform: translateY(0); 
        }
        .emoji-picker { 
            max-height: 200px; 
            overflow-y: auto; 
        }
    </style>
</head>
<body class="bg-background-cream">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <a href="index.html" class="flex items-center">
                        <img src="/assets/juribank-logo.svg" alt="JuriBank" class="h-8 w-auto">
                        <span class="ml-2 text-xl font-semibold text-gray-900">JuriBank</span>
                        <span class="ml-2 text-sm bg-student-blue text-white px-2 py-1 rounded-full">by Students</span>
                    </a>
                </div>
                <div class="hidden md:flex items-center space-x-6">
                    <a href="index.html" class="text-gray-700 hover:text-student-blue font-medium">Home</a>
                    <a href="claim-wizard.html" class="text-gray-700 hover:text-student-blue font-medium">Free Tools</a>
                    <a href="knowledge-hub.html" class="text-gray-700 hover:text-student-blue font-medium">Knowledge Hub</a>
                    <a href="community-forum.html" class="text-student-blue font-medium">Community</a>
                    <button class="bg-student-blue text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700">
                        Sign Up Free
                    </button>
                </div>
                <div class="md:hidden">
                    <button class="text-gray-700">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900 mb-4">Community Forum</h1>
            <p class="text-xl text-gray-600 mb-6">Anonymous discussions moderated by law students</p>
            <div class="flex justify-center items-center space-x-4 text-sm">
                <div class="flex items-center bg-blue-100 text-blue-800 px-3 py-1 rounded-full">
                    <i class="fas fa-user-secret mr-2"></i>
                    <span>Anonymous posting</span>
                </div>
                <div class="flex items-center bg-green-100 text-green-800 px-3 py-1 rounded-full">
                    <i class="fas fa-graduation-cap mr-2"></i>
                    <span>Student moderated</span>
                </div>
                <div class="flex items-center bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full">
                    <i class="fas fa-info-circle mr-2"></i>
                    <span>Educational platform</span>
                </div>
            </div>
        </div>

        <!-- Forum Stats -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
            <div class="bg-white rounded-xl shadow-lg p-6 text-center">
                <div class="text-3xl font-bold text-student-blue mb-2">1,247</div>
                <div class="text-sm text-gray-600">Total Posts</div>
            </div>
            <div class="bg-white rounded-xl shadow-lg p-6 text-center">
                <div class="text-3xl font-bold text-student-green mb-2">423</div>
                <div class="text-sm text-gray-600">Active Members</div>
            </div>
            <div class="bg-white rounded-xl shadow-lg p-6 text-center">
                <div class="text-3xl font-bold text-student-orange mb-2">89%</div>
                <div class="text-sm text-gray-600">Questions Answered</div>
            </div>
            <div class="bg-white rounded-xl shadow-lg p-6 text-center">
                <div class="text-3xl font-bold text-purple-600 mb-2">12</div>
                <div class="text-sm text-gray-600">Student Moderators</div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
            <div class="flex flex-col sm:flex-row items-center justify-between">
                <div class="flex items-center space-x-4 mb-4 sm:mb-0">
                    <h2 class="text-xl font-semibold text-gray-900">What's on your mind?</h2>
                    <span class="text-gray-500">Share your question or experience anonymously</span>
                </div>
                <button id="new-post-btn" class="bg-student-blue text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 flex items-center">
                    <i class="fas fa-plus mr-2"></i>
                    New Post
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="grid lg:grid-cols-4 gap-8">
            <!-- Categories Sidebar -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-2xl shadow-lg p-6 sticky top-24">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Categories</h3>
                    <div class="space-y-2">
                        <button class="category-btn w-full text-left p-3 rounded-lg category-active text-white" data-category="all">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-home mr-3"></i>
                                    <span class="font-medium">All Posts</span>
                                </div>
                                <span class="text-sm opacity-80">247</span>
                            </div>
                        </button>
                        
                        <button class="category-btn w-full text-left p-3 rounded-lg hover:bg-gray-50" data-category="banking">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-university mr-3 text-blue-600"></i>
                                    <span class="font-medium">Banking Issues</span>
                                </div>
                                <span class="text-sm text-gray-500">142</span>
                            </div>
                        </button>
                        
                        <button class="category-btn w-full text-left p-3 rounded-lg hover:bg-gray-50" data-category="payments">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-credit-card mr-3 text-green-600"></i>
                                    <span class="font-medium">Payment Problems</span>
                                </div>
                                <span class="text-sm text-gray-500">89</span>
                            </div>
                        </button>
                        
                        <button class="category-btn w-full text-left p-3 rounded-lg hover:bg-gray-50" data-category="ppi">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-shield-alt mr-3 text-purple-600"></i>
                                    <span class="font-medium">PPI Claims</span>
                                </div>
                                <span class="text-sm text-gray-500">67</span>
                            </div>
                        </button>
                        
                        <button class="category-btn w-full text-left p-3 rounded-lg hover:bg-gray-50" data-category="investment">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-chart-line mr-3 text-orange-600"></i>
                                    <span class="font-medium">Investment Issues</span>
                                </div>
                                <span class="text-sm text-gray-500">34</span>
                            </div>
                        </button>
                        
                        <button class="category-btn w-full text-left p-3 rounded-lg hover:bg-gray-50" data-category="mortgage">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-home mr-3 text-red-600"></i>
                                    <span class="font-medium">Mortgage Help</span>
                                </div>
                                <span class="text-sm text-gray-500">28</span>
                            </div>
                        </button>
                        
                        <button class="category-btn w-full text-left p-3 rounded-lg hover:bg-gray-50" data-category="success">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-trophy mr-3 text-yellow-600"></i>
                                    <span class="font-medium">Success Stories</span>
                                </div>
                                <span class="text-sm text-gray-500">23</span>
                            </div>
                        </button>
                    </div>

                    <!-- Category Guidelines -->
                    <div class="mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200">
                        <h4 class="font-medium text-yellow-800 mb-2">
                            <i class="fas fa-lightbulb mr-2"></i>
                            Community Guidelines
                        </h4>
                        <ul class="text-sm text-yellow-700 space-y-1">
                            <li>• Keep discussions respectful</li>
                            <li>• Educational information only</li>
                            <li>• No personal legal advice</li>
                            <li>• Protect your privacy</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Forum Posts -->
            <div class="lg:col-span-3">
                <!-- Sorting & Filters -->
                <div class="bg-white rounded-xl shadow-lg p-4 mb-6">
                    <div class="flex flex-col sm:flex-row items-center justify-between space-y-3 sm:space-y-0">
                        <div class="flex items-center space-x-4">
                            <select class="px-3 py-2 border border-gray-300 rounded-lg text-sm">
                                <option>Most Recent</option>
                                <option>Most Popular</option>
                                <option>Most Answered</option>
                                <option>Trending</option>
                            </select>
                            <button class="flex items-center text-sm text-gray-600 hover:text-student-blue">
                                <i class="fas fa-filter mr-2"></i>
                                Filter
                            </button>
                        </div>
                        <div class="flex items-center space-x-2 text-sm text-gray-600">
                            <span>247 discussions</span>
                            <span>•</span>
                            <span>23 new today</span>
                        </div>
                    </div>
                </div>

                <!-- Forum Posts List -->
                <div id="forum-posts" class="space-y-4">
                    <!-- Post 1 - Recent Question -->
                    <div class="post-item bg-white rounded-xl shadow-lg p-6 cursor-pointer" data-post-id="1">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex items-center space-x-3">
                                <div class="bg-gray-300 w-10 h-10 rounded-full flex items-center justify-center">
                                    <i class="fas fa-user text-gray-600"></i>
                                </div>
                                <div>
                                    <h3 class="font-semibold text-gray-900">Bank charged me £200 for going £5 overdrawn - is this fair?</h3>
                                    <div class="flex items-center space-x-2 text-sm text-gray-600">
                                        <span>Anonymous User</span>
                                        <span>•</span>
                                        <span>2 hours ago</span>
                                        <span>•</span>
                                        <span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs">Banking Issues</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <button class="text-gray-400 hover:text-red-500">
                                    <i class="fas fa-heart"></i>
                                </button>
                                <button class="text-gray-400 hover:text-student-blue">
                                    <i class="fas fa-bookmark"></i>
                                </button>
                            </div>
                        </div>
                        
                        <p class="text-gray-700 mb-4">I went £5 over my overdraft limit for one day and my bank charged me £200 in fees. This seems excessive - what are my options? Has anyone else experienced this?</p>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-thumbs-up mr-1"></i>
                                    <span>12</span>
                                </button>
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-comment mr-1"></i>
                                    <span>8 replies</span>
                                </button>
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-share mr-1"></i>
                                    <span>Share</span>
                                </button>
                            </div>
                            <span class="text-sm text-gray-500">Last reply 1 hour ago</span>
                        </div>
                    </div>

                    <!-- Post 2 - Success Story -->
                    <div class="post-item bg-white rounded-xl shadow-lg p-6 cursor-pointer" data-post-id="2">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex items-center space-x-3">
                                <div class="bg-gray-300 w-10 h-10 rounded-full flex items-center justify-center">
                                    <i class="fas fa-user text-gray-600"></i>
                                </div>
                                <div>
                                    <h3 class="font-semibold text-gray-900">Successfully got £3,000 PPI refund - here's how</h3>
                                    <div class="flex items-center space-x-2 text-sm text-gray-600">
                                        <span>Anonymous User</span>
                                        <span>•</span>
                                        <span>1 day ago</span>
                                        <span>•</span>
                                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Success Story</span>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-green-100 w-8 h-8 rounded-full flex items-center justify-center">
                                <i class="fas fa-trophy text-green-600"></i>
                            </div>
                        </div>
                        
                        <p class="text-gray-700 mb-4">Want to share my experience claiming PPI - took 6 months but worth it. Happy to answer questions about the process and what documents you need...</p>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-thumbs-up mr-1"></i>
                                    <span>34</span>
                                </button>
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-comment mr-1"></i>
                                    <span>23 replies</span>
                                </button>
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-share mr-1"></i>
                                    <span>Share</span>
                                </button>
                            </div>
                            <span class="text-sm text-gray-500">Last reply 3 hours ago</span>
                        </div>
                    </div>

                    <!-- Post 3 - Student Moderator Guidance -->
                    <div class="post-item bg-white rounded-xl shadow-lg p-6 cursor-pointer border-l-4 border-student-blue" data-post-id="3">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex items-center space-x-3">
                                <div class="bg-student-blue w-10 h-10 rounded-full flex items-center justify-center">
                                    <i class="fas fa-graduation-cap text-white"></i>
                                </div>
                                <div>
                                    <h3 class="font-semibold text-gray-900">Law Student Guidance: New FCA Rules on Overdrafts</h3>
                                    <div class="flex items-center space-x-2 text-sm">
                                        <span class="moderator-badge text-white px-2 py-1 rounded-full text-xs font-medium">
                                            <i class="fas fa-graduation-cap mr-1"></i>
                                            Law Student Moderator
                                        </span>
                                        <span class="text-gray-600">•</span>
                                        <span class="text-gray-600">3 days ago</span>
                                        <span class="text-gray-600">•</span>
                                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs">Official Guidance</span>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-blue-100 w-8 h-8 rounded-full flex items-center justify-center">
                                <i class="fas fa-shield-alt text-blue-600"></i>
                            </div>
                        </div>
                        
                        <p class="text-gray-700 mb-4">Summary of new FCA rules affecting overdraft charges - what this means for your existing and future claims. This is educational information to help you understand your rights...</p>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-thumbs-up mr-1"></i>
                                    <span>67</span>
                                </button>
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-comment mr-1"></i>
                                    <span>15 replies</span>
                                </button>
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-share mr-1"></i>
                                    <span>Share</span>
                                </button>
                            </div>
                            <span class="text-sm text-blue-600 font-medium">📌 Pinned post</span>
                        </div>
                    </div>

                    <!-- Post 4 - Question about Mortgages -->
                    <div class="post-item bg-white rounded-xl shadow-lg p-6 cursor-pointer" data-post-id="4">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex items-center space-x-3">
                                <div class="bg-gray-300 w-10 h-10 rounded-full flex items-center justify-center">
                                    <i class="fas fa-user text-gray-600"></i>
                                </div>
                                <div>
                                    <h3 class="font-semibold text-gray-900">Mortgage application rejected - what can I do?</h3>
                                    <div class="flex items-center space-x-2 text-sm text-gray-600">
                                        <span>Anonymous User</span>
                                        <span>•</span>
                                        <span>2 days ago</span>
                                        <span>•</span>
                                        <span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs">Mortgage Help</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <p class="text-gray-700 mb-4">My mortgage was rejected with no clear explanation. Credit score is good, income stable. What rights do I have to understand why? Anyone been through similar?</p>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-thumbs-up mr-1"></i>
                                    <span>18</span>
                                </button>
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-comment mr-1"></i>
                                    <span>12 replies</span>
                                </button>
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-share mr-1"></i>
                                    <span>Share</span>
                                </button>
                            </div>
                            <span class="text-sm text-gray-500">Last reply 8 hours ago</span>
                        </div>
                    </div>

                    <!-- Load More -->
                    <div class="text-center py-8">
                        <button class="bg-student-blue text-white px-8 py-3 rounded-lg font-medium hover:bg-blue-700">
                            Load More Posts
                        </button>
                        <p class="text-sm text-gray-600 mt-2">Showing 4 of 247 posts</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating New Post Composer -->
    <div id="post-composer" class="floating-composer fixed inset-x-0 bottom-0 bg-white border-t border-gray-200 shadow-2xl z-50">
        <div class="max-w-4xl mx-auto p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-gray-900">Create New Post</h3>
                <button id="close-composer" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="new-post-form" class="space-y-4">
                <!-- Category Selection -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                    <select name="category" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-student-blue focus:border-transparent">
                        <option value="">Select a category...</option>
                        <option value="banking">Banking Issues</option>
                        <option value="payments">Payment Problems</option>
                        <option value="ppi">PPI Claims</option>
                        <option value="investment">Investment Issues</option>
                        <option value="mortgage">Mortgage Help</option>
                        <option value="success">Success Stories</option>
                    </select>
                </div>

                <!-- Title -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Title</label>
                    <input type="text" name="title" placeholder="Briefly describe your question or situation..." 
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-student-blue focus:border-transparent">
                </div>

                <!-- Content -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Your Message</label>
                    <textarea name="content" rows="4" placeholder="Share more details about your situation. Remember to keep personal information private..." 
                              class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-student-blue focus:border-transparent resize-none"></textarea>
                </div>

                <!-- Post Options -->
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <button type="button" class="text-gray-600 hover:text-student-blue" title="Add emoji">
                            <i class="fas fa-smile"></i>
                        </button>
                        <button type="button" class="text-gray-600 hover:text-student-blue" title="Anonymous posting">
                            <i class="fas fa-user-secret"></i>
                            <span class="text-sm ml-1">Anonymous</span>
                        </button>
                    </div>
                    <div class="flex items-center space-x-3">
                        <button type="button" id="cancel-post" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="px-6 py-2 bg-student-blue text-white rounded-lg font-medium hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed" disabled>
                            Post Anonymously
                        </button>
                    </div>
                </div>
            </form>

            <!-- Guidelines Reminder -->
            <div class="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                <p class="text-sm text-yellow-800">
                    <i class="fas fa-info-circle mr-2"></i>
                    <strong>Remember:</strong> This is an educational platform. Share experiences and ask questions, but don't provide or request specific legal advice. Keep all personal information private.
                </p>
            </div>
        </div>
    </div>

    <!-- Educational Notice -->
    <div class="bg-yellow-50 border-t-4 border-yellow-400 py-8 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h3 class="text-lg font-semibold text-yellow-800 mb-2">Educational Community Guidelines</h3>
                <p class="text-yellow-700 text-sm max-w-4xl mx-auto">
                    This community forum is moderated by law students for educational purposes. We encourage sharing experiences and asking questions, but please remember that no content here constitutes legal advice. When professional representation is needed, we connect you with qualified solicitors from our verified network.
                </p>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/src/community-forum.js"></script>
    <script>
        // Community Forum Application
        class CommunityForum {
            constructor() {
                this.currentCategory = 'all';
                this.currentSort = 'recent';
                this.posts = [];
                
                this.initializeEventListeners();
                this.loadPosts();
            }

            initializeEventListeners() {
                // Category buttons
                document.querySelectorAll('.category-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.selectCategory(e.currentTarget.dataset.category);
                    });
                });

                // New post button
                document.getElementById('new-post-btn').addEventListener('click', () => {
                    this.showPostComposer();
                });

                // Close composer
                document.getElementById('close-composer').addEventListener('click', () => {
                    this.hidePostComposer();
                });

                document.getElementById('cancel-post').addEventListener('click', () => {
                    this.hidePostComposer();
                });

                // Form validation
                const form = document.getElementById('new-post-form');
                const inputs = form.querySelectorAll('input, textarea, select');
                const submitBtn = form.querySelector('button[type="submit"]');

                inputs.forEach(input => {
                    input.addEventListener('input', () => {
                        this.validateForm(form, submitBtn);
                    });
                });

                // Form submission
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.submitPost(new FormData(form));
                });

                // Post interactions
                document.addEventListener('click', (e) => {
                    if (e.target.closest('.post-item')) {
                        const postId = e.target.closest('.post-item').dataset.postId;
                        this.openPost(postId);
                    }
                });

                // Sort and filter
                document.querySelector('select').addEventListener('change', (e) => {
                    this.currentSort = e.target.value.toLowerCase().replace(' ', '-');
                    this.loadPosts();
                });
            }

            selectCategory(category) {
                this.currentCategory = category;
                
                // Update UI
                document.querySelectorAll('.category-btn').forEach(btn => {
                    btn.classList.remove('category-active', 'text-white');
                    btn.classList.add('hover:bg-gray-50');
                });

                const selectedBtn = document.querySelector(`[data-category="${category}"]`);
                selectedBtn.classList.add('category-active', 'text-white');
                selectedBtn.classList.remove('hover:bg-gray-50');

                // Load filtered posts
                this.loadPosts();
            }

            loadPosts() {
                // Simulate loading posts based on category and sort
                const postsContainer = document.getElementById('forum-posts');
                
                // Show loading state
                postsContainer.innerHTML = `
                    <div class="text-center py-12">
                        <div class="animate-spin w-8 h-8 border-4 border-student-blue border-t-transparent rounded-full mx-auto mb-4"></div>
                        <p class="text-gray-600">Loading posts...</p>
                    </div>
                `;

                // Simulate API call
                setTimeout(() => {
                    this.renderPosts();
                }, 1000);
            }

            renderPosts() {
                // This would normally come from an API
                const allPosts = this.getFilteredPosts();
                const postsContainer = document.getElementById('forum-posts');
                
                postsContainer.innerHTML = allPosts.map(post => this.renderPost(post)).join('') + `
                    <div class="text-center py-8">
                        <button class="bg-student-blue text-white px-8 py-3 rounded-lg font-medium hover:bg-blue-700">
                            Load More Posts
                        </button>
                        <p class="text-sm text-gray-600 mt-2">Showing ${allPosts.length} of 247 posts</p>
                    </div>
                `;
            }

            getFilteredPosts() {
                // Mock data - would come from API
                const mockPosts = [
                    {
                        id: 1,
                        title: "Bank charged me £200 for going £5 overdrawn - is this fair?",
                        content: "I went £5 over my overdraft limit for one day and my bank charged me £200 in fees. This seems excessive - what are my options?",
                        category: "banking",
                        author: "Anonymous User",
                        timestamp: "2 hours ago",
                        likes: 12,
                        replies: 8,
                        lastReply: "1 hour ago"
                    },
                    {
                        id: 2,
                        title: "Successfully got £3,000 PPI refund - here's how",
                        content: "Want to share my experience claiming PPI - took 6 months but worth it. Happy to answer questions about the process...",
                        category: "success",
                        author: "Anonymous User",
                        timestamp: "1 day ago",
                        likes: 34,
                        replies: 23,
                        lastReply: "3 hours ago",
                        isSuccess: true
                    }
                ];

                if (this.currentCategory === 'all') return mockPosts;
                return mockPosts.filter(post => post.category === this.currentCategory);
            }

            renderPost(post) {
                const categoryClass = this.getCategoryClass(post.category);
                const successIcon = post.isSuccess ? `
                    <div class="bg-green-100 w-8 h-8 rounded-full flex items-center justify-center">
                        <i class="fas fa-trophy text-green-600"></i>
                    </div>
                ` : '';

                return `
                    <div class="post-item bg-white rounded-xl shadow-lg p-6 cursor-pointer" data-post-id="${post.id}">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex items-center space-x-3">
                                <div class="bg-gray-300 w-10 h-10 rounded-full flex items-center justify-center">
                                    <i class="fas fa-user text-gray-600"></i>
                                </div>
                                <div>
                                    <h3 class="font-semibold text-gray-900">${post.title}</h3>
                                    <div class="flex items-center space-x-2 text-sm text-gray-600">
                                        <span>${post.author}</span>
                                        <span>•</span>
                                        <span>${post.timestamp}</span>
                                        <span>•</span>
                                        <span class="${categoryClass} px-2 py-1 rounded-full text-xs">${this.formatCategory(post.category)}</span>
                                    </div>
                                </div>
                            </div>
                            ${successIcon}
                        </div>
                        
                        <p class="text-gray-700 mb-4">${post.content}</p>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-thumbs-up mr-1"></i>
                                    <span>${post.likes}</span>
                                </button>
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-comment mr-1"></i>
                                    <span>${post.replies} replies</span>
                                </button>
                                <button class="flex items-center text-gray-600 hover:text-student-blue">
                                    <i class="fas fa-share mr-1"></i>
                                    <span>Share</span>
                                </button>
                            </div>
                            <span class="text-sm text-gray-500">Last reply ${post.lastReply}</span>
                        </div>
                    </div>
                `;
            }

            getCategoryClass(category) {
                const classes = {
                    banking: 'bg-red-100 text-red-800',
                    payments: 'bg-green-100 text-green-800',
                    ppi: 'bg-purple-100 text-purple-800',
                    investment: 'bg-orange-100 text-orange-800',
                    mortgage: 'bg-red-100 text-red-800',
                    success: 'bg-green-100 text-green-800'
                };
                return classes[category] || 'bg-gray-100 text-gray-800';
            }

            formatCategory(category) {
                const names = {
                    banking: 'Banking Issues',
                    payments: 'Payment Problems', 
                    ppi: 'PPI Claims',
                    investment: 'Investment Issues',
                    mortgage: 'Mortgage Help',
                    success: 'Success Story'
                };
                return names[category] || category;
            }

            showPostComposer() {
                const composer = document.getElementById('post-composer');
                composer.classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            hidePostComposer() {
                const composer = document.getElementById('post-composer');
                composer.classList.remove('active');
                document.body.style.overflow = '';
                
                // Reset form
                document.getElementById('new-post-form').reset();
                this.validateForm(document.getElementById('new-post-form'), document.querySelector('button[type="submit"]'));
            }

            validateForm(form, submitBtn) {
                const title = form.querySelector('input[name="title"]').value.trim();
                const content = form.querySelector('textarea[name="content"]').value.trim();
                const category = form.querySelector('select[name="category"]').value;

                const isValid = title.length >= 10 && content.length >= 20 && category;
                
                submitBtn.disabled = !isValid;
                
                if (isValid) {
                    submitBtn.textContent = 'Post Anonymously';
                } else {
                    submitBtn.textContent = 'Complete all fields';
                }
            }

            async submitPost(formData) {
                const submitBtn = document.querySelector('button[type="submit"]');
                submitBtn.innerHTML = '<i class="fas fa-spinner animate-spin mr-2"></i>Posting...';
                submitBtn.disabled = true;

                try {
                    // Simulate API call
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    this.showNotification('Post created successfully!', 'success');
                    this.hidePostComposer();
                    this.loadPosts(); // Refresh posts
                    
                } catch (error) {
                    this.showNotification('Failed to create post. Please try again.', 'error');
                } finally {
                    submitBtn.innerHTML = 'Post Anonymously';
                    submitBtn.disabled = false;
                }
            }

            openPost(postId) {
                // In a real app, this would navigate to the full post view
                console.log('Opening post:', postId);
                this.showNotification('Post view coming soon!', 'info');
            }

            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `fixed top-20 right-4 z-50 px-4 py-3 rounded-lg shadow-lg text-white transform transition-all duration-300 translate-x-full`;
                
                switch (type) {
                    case 'success':
                        notification.classList.add('bg-green-500');
                        break;
                    case 'error':
                        notification.classList.add('bg-red-500');
                        break;
                    default:
                        notification.classList.add('bg-blue-500');
                }

                notification.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation-triangle' : 'info-circle'} mr-2"></i>
                        <span>${message}</span>
                    </div>
                `;

                document.body.appendChild(notification);

                // Animate in
                setTimeout(() => {
                    notification.classList.remove('translate-x-full');
                }, 100);

                // Remove after 3 seconds
                setTimeout(() => {
                    notification.classList.add('translate-x-full');
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
            }
        }

        // Initialize forum
        document.addEventListener('DOMContentLoaded', () => {
            new CommunityForum();
        });
    </script>
</body>
</html>